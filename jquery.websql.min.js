/* WebSQL (v0.1) Paul Sayre */
(function(a){var d=a.WebSQL=function(g,q,r,s,t){var o=a.openDatabase&&a.openDatabase(g,q||"1.0",r||g,s||5E6,t),p=o&&{query:function(a){var g=d.Deferred(),l=k(a)?a:arguments;p.rawTx(function(a){var h=d.Deferred(),c,e,b,i,j,m,f,n=h.reject;b=0;for(i=l.length;b<i;b++)if(c=l[b],e=l[b+1],"function"===typeof c&&(c=c.toString(),c=c.substr(c.indexOf("/*!")+3),c=c.substr(0,c.lastIndexOf("*/"))),k(e))if(b+=1,k(e[0])){j=0;for(m=e.length;j<m;j++)b+1===i&&j+1===m&&(f=h.resolve),a.executeSql(c,e[j],f,n)}else b+
1===i&&(f=h.resolve),a.executeSql(c,e,f,n);else b+1===i&&(f=h.resolve),a.executeSql(c,[],f,n);h.fail(g.reject).done(function(a,c){var b=null,d,e;if(c){if(e=c.rows){b=[];for(d=0;d<e.length;d++)b[d]=e.item(d)}if(b&&0===b.length)try{b.insertId=c.insertId}catch(f){b.insertId=null}else b.insertId=null}g.resolve(b)})});return g.promise()},rawTx:function(a){o.transaction(a)}};return p},k=Array.isArray||function(a){return!!(a&&a.constructor===Array)}})(window);
(function(a,d){d.when=a.when;d.Deferred=a.Deferred;a.WebSQL=d})(jQuery,WebSQL);
