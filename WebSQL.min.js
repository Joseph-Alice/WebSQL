(function(f){var e=function(c,a,b,j,d){var h=f.openDatabase&&f.openDatabase(c,a||"1.0",b||c,j||5E6,d),n=h&&{query:function(b){var j=e.Deferred(),c=e.isArray(b)?b:arguments;n.rawTx(function(b){var a=e.Deferred(),d,f,g,k,l,h,i,m=a.reject;g=0;for(k=c.length;g<k;g++)if(d=c[g],f=c[g+1],"function"===typeof d&&(d=d.toString(),d=d.substr(d.indexOf("/*!")+3),d=d.substr(0,d.lastIndexOf("*/"))),e.isArray(f))if(g+=1,e.isArray(f[0])){l=0;for(h=f.length;l<h;l++)g+1===k&&l+1===h&&(i=a.resolve),b.executeSql(d,f[l],i,m)}else g+1===k&&(i=a.resolve),b.executeSql(d,f,i,m);else g+1===k&&(i=a.resolve),b.executeSql(d,f,i,m);a.fail(j.reject).done(function(b,d){var c=null,a,e;if(d)if(e=d.rows){c=[];for(a=0;a<e.length;a++)c[a]=e.item(a)}else d.insertId&&(c=d.insertId);j.resolve(c)})});return j.promise()},rawTx:function(b){h.transaction(b)}};return n};f[e.name]=e})(this);(function(f){f.isArray=Array.isArray||function(e){return!!(e&&e.constructor===Array)};f.Deferred=function(){var e,c=f.Callbacks(),a=f.Callbacks(),b={promise:function(){var a={},d=function(b){b();return a};a.always=d(b.always);a.done=d(b.done);a.fail=d(b.fail);a.then=d(b.then);a.state=b.state;return a},state:function(){return e||"pending"},resolve:function(){e||(e="resolved",c.fire.apply(c,arguments));return b},reject:function(){e||(e="rejected",a.fire.apply(a,arguments));return b},always:function(a){return b.then(a,a)},done:function(a){c.add(a);return b},fail:function(c){a.add(c);return b},then:function(a,d){return b.done(a).fail(d)}};return b};f.when=function(e){var c,a=Array(arguments.length),b=f.Deferred();for(c=0;c<arguments.length;c++)arguments[c].fail(function(){b.reject.apply(this,arguments);a=null});for(c=0;c<arguments.length;c++)(function(c){arguments[c].done(function(){a[c]=arguments;for(var d=0;d<a.length&&void 0!==a[d];d++);d===a.length&&b.resolve.apply(b,a)})})(c);return b.promise()};f.Callbacks=function(){var e=[],c,a={hasFired:function(){return!!c},add:function(b){e.push(b);a.hasFired()&&a.fire.apply(a,c)},fire:function(){c=arguments;for(var b=0;b<e.length;b++)e[b].apply(a,c);e=[]}};return a}})(WebSQL);